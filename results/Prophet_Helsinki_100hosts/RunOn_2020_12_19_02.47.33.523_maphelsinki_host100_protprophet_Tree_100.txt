if(or(not(notEqual(notEqual(or(canStartTransfer,isTransferring),not(isTransferring)),isTransferring)),canStartTransfer),add(if(notEqual(or(notEqual(canStartTransfer,isTransferring),isTransferring),not(isTransferring)),add(exchangeDeliverableMessages,tryAllMessagesToAllConnections)),add(add(exchangeDeliverableMessages,exchangeDeliverableMessages),add(if(isTransferring,tryOtherMessages),if(canStartTransfer,update)))))